# üêç Image Moderation API

**–°–µ—Ä–≤–µ—Ä –Ω–∞ FastAPI –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –Ω–∞ NSFW-–∫–æ–Ω—Ç–µ–Ω—Ç —á–µ—Ä–µ–∑ DeepAI.**

## üñã –û–ø–∏—Å–∞–Ω–∏–µ

–≠—Ç–æ backend-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–∞ FastAPI, –∫–æ—Ç–æ—Ä–æ–µ –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –∏—Ö –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –Ω–µ–∂–µ–ª–∞—Ç–µ–ª—å–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞ (NSFW) —Å –ø–æ–º–æ—â—å—é DeepAI API.

## üõ† –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞

### üìå 1. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è

```bash
git clone https://github.com/AndreyBychenkow/ImgModerApi
cd ImgModerApi
```

### üìå 2. –°–æ–∑–¥–∞–Ω–∏–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è

```bash
python -m venv venv

# –ê–∫—Ç–∏–≤–∞—Ü–∏—è –Ω–∞ Windows
venv\Scripts\activate

# –ê–∫—Ç–∏–≤–∞—Ü–∏—è –Ω–∞ macOS/Linux
source venv/bin/activate
```

### üìå 3. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
pip install -r requirements.txt
```

### üìå 4. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ API –∫–ª—é—á–∞

1. –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å –Ω–∞ [DeepAI](https://deepai.org/) –∏ –ø–æ–ª—É—á–∏—Ç–µ API –∫–ª—é—á
2. –°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.env` –∏ –≤—Å—Ç–∞–≤—å—Ç–µ –≤–∞—à API –∫–ª—é—á:

```
DEEPAI_API_KEY=your_actual_api_key_here
```

## üöÄ –ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–µ—Ä–∞

```bash
python main.py
```

–°–µ—Ä–≤–∏—Å –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ –∞–¥—Ä–µ—Å—É **http://localhost:8000/** (Swagger UI ‚Äî **/docs**).

## üß∑ –≠–Ω–¥–ø–æ–∏–Ω—Ç—ã

| –ú–µ—Ç–æ–¥ | –ü—É—Ç—å        | –û–ø–∏—Å–∞–Ω–∏–µ                                  |
|-------|-------------|-------------------------------------------|
| POST  | /moderate   | –ü—Ä–∏–Ω–∏–º–∞–µ—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ (.jpg/.jpeg/.png)   |
| GET   | /           | –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏ —Å–µ—Ä–≤–µ—Ä–∞        |
| GET   | /health     | –ü—Ä–æ–≤–µ—Ä–∫–∞ ¬´–∑–¥–æ—Ä–æ–≤—å—è¬ª —Å–µ—Ä–≤–∏—Å–∞               |

![swager](https://github.com/user-attachments/assets/a92780e4-9e9a-4b10-af1d-cfd169937bb5)

![swagger_2](https://github.com/user-attachments/assets/a97ac322-fbf7-4233-b1d8-db7213359a87)

### üîó –ü—Ä–∏–º–µ—Ä—ã –∑–∞–ø—Ä–æ—Å–æ–≤

#### üóù curl

```bash
curl -X POST -F "file=@example.jpg" http://localhost:8000/moderate
```

#### üóù Postman
1. –ú–µ—Ç–æ–¥: POST
2. URL: http://localhost:8000/moderate
3. –í Body –≤—ã–±—Ä–∞—Ç—å form-data
4. –ö–ª—é—á: file (—Ç–∏–ø ‚Äî File), –≤—ã–±—Ä–∞—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ
5. –ù–∞–∂–∞—Ç—å Send


### üîó –ü—Ä–∏–º–µ—Ä—ã –æ—Ç–≤–µ—Ç–æ–≤

#### üü¢ –ë–µ–∑–æ–ø–∞—Å–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ:

```json
{
    "status": "OK"
}
```

#### ‚õî –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å –Ω–µ–∂–µ–ª–∞—Ç–µ–ª—å–Ω—ã–º –∫–æ–Ω—Ç–µ–Ω—Ç–æ–º:

```json
{
    "status": "REJECTED",
    "reason": "NSFW content"
}
```

## üìù –õ–æ–≥–∏–∫–∞ –º–æ–¥–µ—Ä–∞—Ü–∏–∏

- –ï—Å–ª–∏ `nsfw_score > 0.7` ‚Üí –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –æ—Ç–∫–ª–æ–Ω—è–µ—Ç—Å—è (REJECTED)
- –í –ø—Ä–æ—Ç–∏–≤–Ω–æ–º —Å–ª—É—á–∞–µ ‚Üí –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –æ–¥–æ–±—Ä–µ–Ω–æ (OK)

## üìù –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã

- `.jpg`
- `.jpeg`
- `.png`

## ‚ö† –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Python 3.8+
- –ê–∫—Ç–∏–≤–Ω—ã–π API –∫–ª—é—á –æ—Ç DeepAI

## üåê API –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

–ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞, –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –¥–æ—Å—Ç—É–ø–Ω–∞ –ø–æ –∞–¥—Ä–µ—Å–∞–º:
- Swagger UI: `http://localhost:8000/docs`
- ReDoc: `http://localhost:8000/redoc`

## ‚è≥ –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

API –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–ª–µ–¥—É—é—â–∏–µ –∫–æ–¥—ã –æ—à–∏–±–æ–∫:
- `400` - –ù–µ–≤–µ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç —Ñ–∞–π–ª–∞
- `500` - –û—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞ –∏–ª–∏ API DeepAI

## ‚ö° –í–∞–∂–Ω–æ

* –ù—É–∂–µ–Ω –∞–∫—Ç—É–∞–ª—å–Ω—ã–π **DEEPAI_API_KEY** ‚Äî –ø–æ–ª—É—á–∏ –µ–≥–æ –Ω–∞ https://deepai.org/
* –ü—Ä–∏ –∏—Å—á–µ—Ä–ø–∞–Ω–∏–∏ –ª–∏–º–∏—Ç–∞ DeepAI –≤–µ—Ä–Ω—ë—Ç –æ—à–∏–±–∫—É ¬´Out of API credits¬ª.
